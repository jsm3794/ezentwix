<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="Employees">

  <sql id="getByIdAndPw">
    SELECT * FROM employees WHERE login_id = #{id} AND login_pw = #{pw}
  </sql>

  <sql id="getEmpList">
    SELECT emp_id, emp_name, emp_email, phone_number, job_title, hire_date, join_date
    FROM employees
    ORDER BY emp_id ASC
  </sql>

  <sql id="getEmpListByFilter">
    SELECT emp_id, emp_name, emp_email, phone_number, job_title, hire_date, join_date
    FROM employees
    <where>
        <if test="emp_name != null and emp_name != ''">
            emp_name LIKE #{emp_name}
        </if>
        <if test="phone_number != null and phone_number != ''">
            AND phone_number LIKE #{phone_number}
        </if>
        <if test="emp_email != null and emp_email != ''">
            AND emp_email LIKE #{emp_email}
        </if>
        <if test="job_title != null and job_title != ''">
            AND job_title LIKE #{job_title}
        </if>
    </where>
    ORDER BY emp_id ASC
  </sql>

  <sql id="getEmp">
    SELECT emp_name, emp_email, phone_number, job_title, login_id, login_pw, hire_date, join_date
    FROM employees WHERE emp_id = #{emp_id}
  </sql>
  
   <sql id="updateEmployees">
        UPDATE employees
        SET
            emp_name = #{emp_name},
            emp_email = #{emp_email},
            phone_number = #{phone_number},
            login_id = #{login_id},
            login_pw = #{login_pw},
            job_title = #{job_title}, 
            hire_date = #{hire_date},   
            join_date = #{join_date}
        WHERE
            emp_id = #{emp_id}
    </sql>

    <update id="updateEmployees" parameterType="emp">
        <include refid="updateEmployees"></include>
    </update>

  <select id="getEmpList" resultType="emp">
    <include refid="getEmpList"/>
  </select>

  <select id="getByIdAndPw" resultType="emp" parameterType="map">
    <include refid="getByIdAndPw"/>
  </select>

  <select id="getEmp" resultType="emp" parameterType="Integer">
    <include refid="getEmp"/>
  </select>

    <select id="getAllJobTitles" resultType="String">
      SELECT job_title FROM employees
    </select>
</mapper>